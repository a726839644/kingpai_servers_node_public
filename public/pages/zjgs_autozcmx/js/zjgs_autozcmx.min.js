+function(c){var e=c("#upload_excel");var d=c("#filename");var b=c("#upload_form");var a=c("#select_statement");var g=c("#view_code");e.on("change",f);function f(){var j=e.val();d.html(j.substring(j.lastIndexOf("\\")+1));c.ajax({url:"/parse_xlsx",type:"post",dataType:"json",data:new FormData(b[0]),async:false,cache:false,contentType:false,processData:false,success:function(k){if(k.length==0){alert("报表格式错误或无内容");a.html("");g.html("")}else{i(k)}},error:function(l,k,m){console.error(m)}});return false}function h(m,k,j){var l=c("<option>");l.prop({value:k});l.html(m);j.append(l)}function i(m){var n={};var j={};for(var l=0;l<m.length;l++){n[m[l].name]=m[l].data}a.html("");for(var k in n){if(n.hasOwnProperty(k)){h(k,k,a);j[k]=o(n[k])}}a.on("change",function(){g.html(j[a.val()])});a.trigger("change");function o(t){var u="";var q=[];for(var s=1;s<t.length;s++){var w={};var v=t[s];w.zj_fphm=v[3];w.zj_jqsbmc=v[9];var r=p(v[8]);if(r.getFullYear()<2012){u="请确认excel开票日期格式是否为日期格式。row = "+s;break}else{w.zj_gmrq=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()}w.zj_sbdj=v[4];w.zj_sbsl=1;w.zj_sbje=v[4];w.zj_dkse=v[5];q.push(w)}return"+function(){var c="+JSON.stringify(q)+';for(var b=0;b<c.length;b++){if(b>0){zj_add()}a(c[b])}function a(e){var g;var f;var j;var h;var l;var i;var d;g=k("zj_fphm");f=k("zj_jqsbmc");j=k("zj_gmrq");h=k("zj_sbdj");l=k("zj_sbsl");i=k("zj_sbje");d=k("zj_dkse");g.value=e.zj_fphm;f.value=e.zj_jqsbmc;j.value=e.zj_gmrq;h.value=e.zj_sbdj;l.value=e.zj_sbsl;i.value=e.zj_sbje;d.value=e.zj_dkse;g.setAttribute("data-input","yes");f.setAttribute("data-input","yes");j.setAttribute("data-input","yes");h.setAttribute("data-input","yes");l.setAttribute("data-input","yes");i.setAttribute("data-input","yes");d.setAttribute("data-input","yes");d.onchange();function k(n){var o=document.getElementsByName(n);for(var m=0;m<o.length;m++){if(o[m].getAttribute("data-input")!="yes"){return o[m]}}}}}();';function p(x){return new Date(new Date(1900,0,0).getTime()-1+x*24*60*60*1000)}}}}(jQuery);