define(["../core","../var/document","../core/init","../deferred"],function(d,a){var e;d.fn.ready=function(f){d.ready.promise().done(f);return this};d.extend({isReady:false,readyWait:1,holdReady:function(f){if(f){d.readyWait++}else{d.ready(true)}},ready:function(f){if(f===true?--d.readyWait:d.isReady){return}d.isReady=true;if(f!==true&&--d.readyWait>0){return}e.resolveWith(a,[d]);if(d.fn.triggerHandler){d(a).triggerHandler("ready");d(a).off("ready")}}});function c(){if(a.addEventListener){a.removeEventListener("DOMContentLoaded",b);window.removeEventListener("load",b)}else{a.detachEvent("onreadystatechange",b);window.detachEvent("onload",b)}}function b(){if(a.addEventListener||window.event.type==="load"||a.readyState==="complete"){c();d.ready()}}d.ready.promise=function(i){if(!e){e=d.Deferred();if(a.readyState==="complete"||(a.readyState!=="loading"&&!a.documentElement.doScroll)){window.setTimeout(d.ready)}else{if(a.addEventListener){a.addEventListener("DOMContentLoaded",b);window.addEventListener("load",b)}else{a.attachEvent("onreadystatechange",b);window.attachEvent("onload",b);var h=false;try{h=window.frameElement==null&&a.documentElement}catch(g){}if(h&&h.doScroll){(function f(){if(!d.isReady){try{h.doScroll("left")}catch(j){return window.setTimeout(f,50)}c();d.ready()}})()}}}}return e.promise(i)};d.ready.promise()});