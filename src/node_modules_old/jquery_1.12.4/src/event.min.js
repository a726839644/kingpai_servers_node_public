define(["./core","./var/document","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/acceptData","./core/init","./data","./selector"],function(p,h,m,f,k,l,i){var b=/^(?:input|select|textarea)$/i,o=/^key/,d=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,j=/^(?:focusinfocus|focusoutblur)$/,c=/^([^.]*)(?:\.(.+)|)/;function e(){return true}function a(){return false}function n(){try{return h.activeElement}catch(q){}}function g(v,s,q,w,u,r){var x,t;if(typeof s==="object"){if(typeof q!=="string"){w=w||q;q=undefined}for(t in s){g(v,t,q,w,s[t],r)}return v}if(w==null&&u==null){u=q;w=q=undefined}else{if(u==null){if(typeof q==="string"){u=w;w=undefined}else{u=w;w=q;q=undefined}}}if(u===false){u=a}else{if(!u){return v}}if(r===1){x=u;u=function(y){p().off(y);return x.apply(this,arguments)};u.guid=x.guid||(x.guid=p.guid++)}return v.each(function(){p.event.add(this,s,u,w,q)})}p.event={global:{},add:function(v,A,F,x,w){var y,G,H,s,C,z,E,u,D,q,r,B=p._data(v);if(!B){return}if(F.handler){s=F;F=s.handler;w=s.selector}if(!F.guid){F.guid=p.guid++}if(!(G=B.events)){G=B.events={}}if(!(z=B.handle)){z=B.handle=function(t){return typeof p!=="undefined"&&(!t||p.event.triggered!==t.type)?p.event.dispatch.apply(z.elem,arguments):undefined};z.elem=v}A=(A||"").match(m)||[""];H=A.length;while(H--){y=c.exec(A[H])||[];D=r=y[1];q=(y[2]||"").split(".").sort();if(!D){continue}C=p.event.special[D]||{};D=(w?C.delegateType:C.bindType)||D;C=p.event.special[D]||{};E=p.extend({type:D,origType:r,data:x,handler:F,guid:F.guid,selector:w,needsContext:w&&p.expr.match.needsContext.test(w),namespace:q.join(".")},s);if(!(u=G[D])){u=G[D]=[];u.delegateCount=0;if(!C.setup||C.setup.call(v,x,q,z)===false){if(v.addEventListener){v.addEventListener(D,z,false)}else{if(v.attachEvent){v.attachEvent("on"+D,z)}}}}if(C.add){C.add.call(v,E);if(!E.handler.guid){E.handler.guid=F.guid}}if(w){u.splice(u.delegateCount++,0,E)}else{u.push(E)}p.event.global[D]=true}v=null},remove:function(u,A,H,v,z){var x,E,y,w,G,F,C,s,D,q,r,B=p.hasData(u)&&p._data(u);if(!B||!(F=B.events)){return}A=(A||"").match(m)||[""];G=A.length;while(G--){y=c.exec(A[G])||[];D=r=y[1];q=(y[2]||"").split(".").sort();if(!D){for(D in F){p.event.remove(u,D+A[G],H,v,true)}continue}C=p.event.special[D]||{};D=(v?C.delegateType:C.bindType)||D;s=F[D]||[];y=y[2]&&new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)");w=x=s.length;while(x--){E=s[x];if((z||r===E.origType)&&(!H||H.guid===E.guid)&&(!y||y.test(E.namespace))&&(!v||v===E.selector||v==="**"&&E.selector)){s.splice(x,1);if(E.selector){s.delegateCount--}if(C.remove){C.remove.call(u,E)}}}if(w&&!s.length){if(!C.teardown||C.teardown.call(u,q,B.handle)===false){p.removeEvent(u,D,B.handle)}delete F[D]}}if(p.isEmptyObject(F)){delete B.handle;p._removeData(u,"events")}},trigger:function(q,x,t,E){var y,s,C,D,A,w,v,u=[t||h],B=f.call(q,"type")?q.type:q,r=f.call(q,"namespace")?q.namespace.split("."):[];C=w=t=t||h;if(t.nodeType===3||t.nodeType===8){return}if(j.test(B+p.event.triggered)){return}if(B.indexOf(".")>-1){r=B.split(".");B=r.shift();r.sort()}s=B.indexOf(":")<0&&"on"+B;q=q[p.expando]?q:new p.Event(B,typeof q==="object"&&q);q.isTrigger=E?2:3;q.namespace=r.join(".");q.rnamespace=q.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;q.result=undefined;if(!q.touchTarget){q.touchTarget=t}x=x==null?[q]:p.makeArray(x,[q]);A=p.event.special[B]||{};if(!E&&A.trigger&&A.trigger.apply(t,x)===false){return}if(!E&&!A.noBubble&&!p.isWindow(t)){D=A.delegateType||B;if(!j.test(D+B)){C=C.parentNode}for(; C; C=C.parentNode){u.push(C);w=C}if(w===(t.ownerDocument||h)){u.push(w.defaultView||w.parentWindow||window)}}v=0;while((C=u[v++])&&!q.isPropagationStopped()){q.type=v>1?D:A.bindType||B;y=(p._data(C,"events")||{})[q.type]&&p._data(C,"handle");if(y){y.apply(C,x)}y=s&&C[s];if(y&&y.apply&&i(C)){q.result=y.apply(C,x);if(q.result===false){q.preventDefault()}}}q.type=B;if(!E&&!q.isDefaultPrevented()){if((!A._default||A._default.apply(u.pop(),x)===false)&&i(t)){if(s&&t[B]&&!p.isWindow(t)){w=t[s];if(w){t[s]=null}p.event.triggered=B;try{t[B]()}catch(z){}p.event.triggered=undefined;if(w){t[s]=w}}}}return q.result},dispatch:function(q){q=p.event.fix(q);var u,t,v,r,z,y=[],x=k.call(arguments),s=(p._data(this,"events")||{})[q.type]||[],w=p.event.special[q.type]||{};x[0]=q;q.delegateTarget=this;if(w.preDispatch&&w.preDispatch.call(this,q)===false){return}y=p.event.handlers.call(this,q,s);u=0;while((r=y[u++])&&!q.isPropagationStopped()){q.currentTarget=r.elem;t=0;while((z=r.handlers[t++])&&!q.isImmediatePropagationStopped()){if(!q.rnamespace||q.rnamespace.test(z.namespace)){q.handleObj=z;q.data=z.data;v=((p.event.special[z.origType]||{}).handle||z.handler).apply(r.elem,x);if(v!==undefined){if((q.result=v)===false){q.preventDefault();q.stopPropagation()}}}}}if(w.postDispatch){w.postDispatch.call(this,q)}return q.result},handlers:function(q, s){var u,v,r,x,w=[],t=s.delegateCount,y=q.touchTarget;if(t&&y.nodeType&&(q.type!=="click"||isNaN(q.button)||q.button<1)){for(; y!=this; y=y.parentNode||this){if(y.nodeType===1&&(y.disabled!==true||q.type!=="click")){v=[];for(u=0; u<t; u++){x=s[u];r=x.selector+" ";if(v[r]===undefined){v[r]=x.needsContext?p(r,this).index(y)>-1:p.find(r,this,null,[y]).length}if(v[r]){v.push(x)}}if(v.length){w.push({elem:y,handlers:v})}}}}if(t<s.length){w.push({elem:this,handlers:s.slice(t)})}return w},fix:function(t){if(t[p.expando]){return t}var r,w,v,s=t.type,q=t,u=this.fixHooks[s];if(!u){this.fixHooks[s]=u=d.test(s)?this.mouseHooks:o.test(s)?this.keyHooks:{}}v=u.props?this.props.concat(u.props):this.props;t=new p.Event(q);r=v.length;while(r--){w=v[r];t[w]=q[w]}if(!t.touchTarget){t.touchTarget=q.srcElement||h}if(t.touchTarget.nodeType===3){t.touchTarget=t.touchTarget.parentNode}t.metaKey=!!t.metaKey;return u.filter?u.filter(t,q):t},props:("altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey touchTarget timeStamp view which").split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(r, q){if(r.which==null){r.which=q.charCode!=null?q.charCode:q.keyCode}return r}},mouseHooks:{props:("button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement").split(" "),filter:function(t, s){var q,u,v,r=s.button,w=s.fromElement;if(t.pageX==null&&s.clientX!=null){u=t.touchTarget.ownerDocument||h;v=u.documentElement;q=u.body;t.pageX=s.clientX+(v&&v.scrollLeft||q&&q.scrollLeft||0)-(v&&v.clientLeft||q&&q.clientLeft||0);t.pageY=s.clientY+(v&&v.scrollTop||q&&q.scrollTop||0)-(v&&v.clientTop||q&&q.clientTop||0)}if(!t.relatedTarget&&w){t.relatedTarget=w===t.touchTarget?s.toElement:w}if(!t.which&&r!==undefined){t.which=(r&1?1:(r&2?3:(r&4?2:0)))}return t}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==n()&&this.focus){try{this.focus();return false}catch(q){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===n()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(p.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}},_default:function(q){return p.nodeName(q.touchTarget,"a")}},beforeunload:{postDispatch:function(q){if(q.result!==undefined&&q.originalEvent){q.originalEvent.returnValue=q.result}}}},simulate:function(q, s, r){var t=p.extend(new p.Event(),r,{type:q,isSimulated:true});p.event.trigger(t,null,s);if(t.isDefaultPrevented()){r.preventDefault()}}};p.removeEvent=h.removeEventListener?function(r, q, s){if(r.removeEventListener){r.removeEventListener(q,s)}}:function(s, r, t){var q="on"+r;if(s.detachEvent){if(typeof s[q]==="undefined"){s[q]=null}s.detachEvent(q,t)}};p.Event=function(r,q){if(!(this instanceof p.Event)){return new p.Event(r,q)}if(r&&r.type){this.originalEvent=r;this.type=r.type;this.isDefaultPrevented=r.defaultPrevented||r.defaultPrevented===undefined&&r.returnValue===false?e:a}else{this.type=r}if(q){p.extend(this,q)}this.timeStamp=r&&r.timeStamp||p.now();this[p.expando]=true};p.Event.prototype={constructor:p.Event,isDefaultPrevented:a,isPropagationStopped:a,isImmediatePropagationStopped:a,preventDefault:function(){var q=this.originalEvent;this.isDefaultPrevented=e;if(!q){return}if(q.preventDefault){q.preventDefault()}else{q.returnValue=false}},stopPropagation:function(){var q=this.originalEvent;this.isPropagationStopped=e;if(!q||this.isSimulated){return}if(q.stopPropagation){q.stopPropagation()}q.cancelBubble=true},stopImmediatePropagation:function(){var q=this.originalEvent;this.isImmediatePropagationStopped=e;if(q&&q.stopImmediatePropagation){q.stopImmediatePropagation()}this.stopPropagation()}};p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(r, q){p.event.special[r]={delegateType:q,bindType:q,handle:function(u){var s,w=this,v=u.relatedTarget,t=u.handleObj;if(!v||(v!==w&&!p.contains(w,v))){u.type=t.origType;s=t.handler.apply(this,arguments);u.type=q}return s}}});if(!l.submit){p.event.special.submit={setup:function(){if(p.nodeName(this,"form")){return false}p.event.add(this,"click._submit keypress._submit",function(s){var r=s.touchTarget,q=p.nodeName(r,"input")||p.nodeName(r,"button")?p.prop(r,"form"):undefined;if(q&&!p._data(q,"submit")){p.event.add(q,"submit._submit",function(t){t._submitBubble=true});p._data(q,"submit",true)}})},postDispatch:function(q){if(q._submitBubble){delete q._submitBubble;if(this.parentNode&&!q.isTrigger){p.event.simulate("submit",this.parentNode,q)}}},teardown:function(){if(p.nodeName(this,"form")){return false}p.event.remove(this,"._submit")}}}if(!l.change){p.event.special.change={setup:function(){if(b.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){p.event.add(this,"propertychange._change",function(q){if(q.originalEvent.propertyName==="checked"){this._justChanged=true}});p.event.add(this,"click._change",function(q){if(this._justChanged&&!q.isTrigger){this._justChanged=false}p.event.simulate("change",this,q)})}return false}p.event.add(this,"beforeactivate._change",function(r){var q=r.touchTarget;if(b.test(q.nodeName)&&!p._data(q,"change")){p.event.add(q,"change._change",function(s){if(this.parentNode&&!s.isSimulated&&!s.isTrigger){p.event.simulate("change",this.parentNode,s)}});p._data(q,"change",true)}})},handle:function(r){var q=r.touchTarget;if(this!==q||r.isSimulated||r.isTrigger||(q.type!=="radio"&&q.type!=="checkbox")){return r.handleObj.handler.apply(this,arguments)}},teardown:function(){p.event.remove(this,"._change");return !b.test(this.nodeName)}}}if(!l.focusin){p.each({focus:"focusin",blur:"focusout"},function(s, q){var r=function(t){p.event.simulate(q,t.touchTarget,p.event.fix(t))};p.event.special[q]={setup:function(){var u=this.ownerDocument||this,t=p._data(u,q);if(!t){u.addEventListener(s,r,true)}p._data(u,q,(t||0)+1)},teardown:function(){var u=this.ownerDocument||this,t=p._data(u,q)-1;if(!t){u.removeEventListener(s,r,true);p._removeData(u,q)}else{p._data(u,q,t)}}}})}p.fn.extend({on:function(r, q, t, s){return g(this,r,q,t,s)},one:function(r, q, t, s){return g(this,r,q,t,s,1)},off:function(s, q, u){var r,t;if(s&&s.preventDefault&&s.handleObj){r=s.handleObj;p(s.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler);return this}if(typeof s==="object"){for(t in s){this.off(t,q,s[t])}return this}if(q===false||typeof q==="function"){u=q;q=undefined}if(u===false){u=a}return this.each(function(){p.event.remove(this,s,u,q)})},trigger:function(q,r){return this.each(function(){p.event.trigger(q,r,this)})},triggerHandler:function(q,s){var r=this[0];if(r){return p.event.trigger(q,s,r,true)}}});return p});